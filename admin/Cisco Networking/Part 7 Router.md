# Part 7 Router
## Router

- 인터넷을 사용하기 위해, 다른 네트워크 간 통신하기 위해, 브로드캐스트 영역을 나누기 위해 사용함
- 지능을 가진 경로 배정기라고 할 수 있다

## Router가 하는일

- Path Determination - 데이터 패킷이 목적지까지 갈 수 있는 길을 검사하고 어떤 길로 가는 것이 가장 적절한지 검사
- Switching - 경로가 결정되면 그쪽으로 데이터 패킷을 스위칭해 준다
- 라우팅 테이블 - 라우팅 테이블을 만들어서 관리함

## 라우터의 형태

- 단독형 - 살때 일체형으로 구성되어있음
- 모듈형 - 껍데기만 산 후 자기가 필요한 모듈을 꽂아 쓰는 모델
- 멀티샤시 구성 - 라우터를 16대까지 붙여 한대의 라우터처럼 사용하는 구성

## 라우팅 프로토콜과 라우티드 프로토콜

- 라우팅 프로토콜의 종류 - RIP, IGRP, OSPF, EIGRP
- 라우팅 프로토콜은 택시 기사 같은 개념이고 라우티드는 승객같은 종류이다
- 라우터는 목적지에 대한 이정표를 가지고 있는데 그것을 라우팅 테이블이라 한다

## Static, Dynamic Routing

- Static routing - 사람이 일일히 경로를 지정해주는 것
    - 라우터 자체에 부담이 들지 않아 라우터의 성능과 속도에 좋음 | 다른 장비들과 라우팅 테이블을 교환할 필요가 없음
    - 단점은 귀찮고 입력한 경로에 문제가 생기면 통신이 안된다는 것이다
- dynamic routing - 상황에 따라서 그때그때 변화가 가능한 것
    - 그때그때 자동으로 판단해 가장 좋은 경로를 찾는다
    - 라우터에 부담을 많이 준다는 단점이있다 | 길 찾기, 계산, 정보체크, 이정표 업데이트

> 다이나믹이 여러 상황에 자동으로 대응할 수 있다는 장점이 있지만 라우팅 성능을 위해 스태틱을 쓰기도 한다
> 

## Routing table

- routing talbe - 라우터가 경로를 찾을때 사용하는 것이며, 사용하는 프로토콜에 따라 다르며 항상 최적의 경로를 찾아 유지한다
- Ram에 저장되기 때문에 전원이 꺼지면 삭제된다 | 재시작 후 수 초, 분 안에 생성이 가능하다

```jsx
show ip route //TCP/IP
show ipx ropute //ipx에서의 경로를 보여줌
```

## AS, 내부 외부용 프로토콜

- AS (Autonomous System) - 하나의 네트워크 관리자에 의해 관리되는 라우터의 집단 (회사나 기업, 단체의 라우터 집단)
- AS 내부에서 사용하는 라우팅 프로토콜을 Interior Routing Protocol 또는 Interior Gateway Protocol (IGP)라고 한다 (RIP, IGRP, EIGRP, OSPF)
- AS간에 라우팅 정보를 주고받기위해 라우터가 사용하는 프로토콜은 Exterior Routing Protocol 또는 Exterior Gateway Protocol 이라고 한다 (EGP, BGP)

## 라우터의 구성

- 콘솔케이블을 이용한 구성
    - 인터넷에서 무료 콘솔 연결 프로그램을 다운로드해 설치 (PuTTY, 하이퍼터미널)
    - 콘솔케이블을 PC, 라우터에 각각 연결
    - 장치관리자에 들어가 콘솔케이블에 어떤 포트에 연결됬는지 확인
    - 콘솔 프로그램을 실행하고 필요한 내용을 입력한다 (포트 번호, 속도, 커넥션 타입)
    - 구성을 저장하기 위해 세션 이름을 만든다
- 콘솔케이블을 이용한 구성은 제품을 처음 구성하는 경우나 고장났을때만 사용하고 한번 라우터가 구성된 이후에는 잘 사용하지 않음 (텔넷 이용)
- 텔넷(가상 터미널)을 이용한 라우터 구성
    - 라우터의 ip주소를 알고있고 네트워크에 접속되어있다면 어디에서든 구성이 가능
    - 맨 처음 구성 시에는 ip주소조차 없기 때문에 텔넷 사용이 불가능
- TFTP(Trivial File Transfer Protocol)를 이용한 라우터 구성
    - TFTP 서버에 의한 라우터구성은 이미 다른 곳에서 만든 라우터의 구성 파일을 tftp 서버에 저장했다가 라우터로 다운로드 시켜주는 방식을 말한다

## Distance Vector와 Link State

- Distance Vector - Distance(거리)와 Vector(방향)만을 위주로 만들어진 라우팅 알고리즘 (소규모 네트워크에 이용) (RIP, IGRP)
    - 라우터는 목적지까지의 모든 경로를 자신의 라우팅테이블 안에 저장하는 것이 아닌 목적지까지의 거리와 목적지까지의 인접라우터를 저장함
    - 한 라우터가 모든 라우팅 정보를 가지고 있을 필요가 없어 메모리를 절약하고 구성 자체가 간단하다
- Link State - 한 라우터에서 목적지까지의 모든 경로를 알고 있음(대형 네트워크에 적합)(OSPF)
    - 중간에 링크의 변화가 생겨도 이를 알아내는 데 시간이 짧다
    - 라우팅 테이블의 교환이 자주 발생하지 않고 교환을 하더라도 테이블에 변화가 있는 것만을 교환하기 때문에 트래픽의 발생을 줄인다

## CDP에 관해서

- CDP - 시스코 장비와 연결된 다른 시스코 장비를 찾아내는 프로토콜
    - 장비의 이름과 같은 확인 정보
    - ip 주소와 같은 주소 정보
    - 접속 포트에 대한 정보
    - 접속 장비의 기능에 대한 정보
    - 접속 장비의 하드웨어 사양
- CDP 패킷이 들어와야 할 시간동안 들어오지 않는다면 최대 180초 동안은 기존의 정보를 가지고 있음 (holdtime)
- 만약 Holdtime이 0이 될 때까지 스위치로부터 CDP 패킷을 받지 못하면 스위치 정보를 자신의 CDP에서 삭제함

```jsx
show cdp traffic //CDP 트래픽이 어떻게 흐르고 있는지 보여주는 명령어
```

- CDP를 비활성화 하는 방법은 라우터 전체를 비활성화하는 방법과 특정 인터페이스로 가는 CDP만을 막는방법, 2가지가 있다 (라우터 전체에 CDP를 disable 하면 상대쪽은 아무 정보도 받을 수 없음)

## Telnet을 이용한 접속

- Telnet 접속을 위해서는 해당 장치에 TCP/IP 가 설치되어 있어야하고 IP 주소를 알고 있어야 한다
- 추가로 VTY에 대한 패스워드를 설정해놓지 않으면 텔넷 접속이 불가능하다

## Ping과 Trace

- 둘다 라우터를 구성 한 후 네트워크의 연결에 이상이 없는지 테스트하기 위해 만든 프로그램
- 확장형 핑 - 단순형 핑을 사용하면 출발지 주소는 라우터를 떠나는 쪽 인터페이스로 자동으로 설정되기 때문에 옵션을 선택할 수 있는 확장형 핑을 사용함
- Trace - 목적지까지의 경로를 하나하나 분석해주는 프로그램 | 돌아오는 에러 메세지를 가지고 경로를 확인한다
    - TTL(Time To Live) - 라우터 하나를 거칠때마다 1씩 감소해 0이 되면 패킷을 버리면서 에러가 발생하도록 한 값 (루핑 방지를 위해 사용)